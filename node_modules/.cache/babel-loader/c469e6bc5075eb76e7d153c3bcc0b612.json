{"ast":null,"code":"import _regeneratorRuntime from\"D:/excercise-t/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";var _marked=/*#__PURE__*/_regeneratorRuntime().mark(watchUserLogin),_marked2=/*#__PURE__*/_regeneratorRuntime().mark(watchUserLogout),_marked3=/*#__PURE__*/_regeneratorRuntime().mark(loginSaga);import{takeEvery,fork,put,all,call}from'redux-saga/effects';// Login Redux States\nimport{CHECK_LOGIN,LOGOUT_USER}from'./actionTypes';import{apiError,loginUserSuccessful,logoutUserSuccess}from'./actions';// AUTH related methods\nimport{postLogin}from'../../../helpers/fackBackend_Helper';import{getFirebaseBackend}from'../../../helpers/firebase_helper';//Initilize firebase\nvar fireBaseBackend=getFirebaseBackend();//If user is login then dispatch redux action's are directly from here.\nfunction loginUser(_ref){var _ref$payload=_ref.payload,user=_ref$payload.user,history=_ref$payload.history;return/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,_response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;if(!(process.env.REACT_APP_DEFAULTAUTH===\"firebase\")){_context.next=9;break;}_context.next=4;return call(fireBaseBackend.loginUser,user.username,user.password);case 4:response=_context.sent;_context.next=7;return put(loginUserSuccessful(response));case 7:_context.next=15;break;case 9:_context.next=11;return call(postLogin,'/post-login',{username:user.username,password:user.password});case 11:_response=_context.sent;localStorage.setItem(\"authUser\",JSON.stringify(_response));_context.next=15;return put(loginUserSuccessful(_response));case 15:history.push('/dashboard');_context.next=22;break;case 18:_context.prev=18;_context.t0=_context[\"catch\"](0);_context.next=22;return put(apiError(_context.t0));case 22:case\"end\":return _context.stop();}},_callee,null,[[0,18]]);})();}function logoutUser(_ref2){var history=_ref2.payload.history;return/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var response;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;localStorage.removeItem(\"authUser\");if(!(process.env.REACT_APP_DEFAULTAUTH==='firebase')){_context2.next=8;break;}_context2.next=5;return call(fireBaseBackend.logout);case 5:response=_context2.sent;_context2.next=8;return put(logoutUserSuccess(response));case 8:history.push('/login');_context2.next=15;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](0);_context2.next=15;return put(apiError(_context2.t0));case 15:case\"end\":return _context2.stop();}},_callee2,null,[[0,11]]);})();}export function watchUserLogin(){return _regeneratorRuntime().wrap(function watchUserLogin$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.next=2;return takeEvery(CHECK_LOGIN,loginUser);case 2:case\"end\":return _context3.stop();}},_marked);}export function watchUserLogout(){return _regeneratorRuntime().wrap(function watchUserLogout$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:_context4.next=2;return takeEvery(LOGOUT_USER,logoutUser);case 2:case\"end\":return _context4.stop();}},_marked2);}function loginSaga(){return _regeneratorRuntime().wrap(function loginSaga$(_context5){while(1)switch(_context5.prev=_context5.next){case 0:_context5.next=2;return all([fork(watchUserLogin),fork(watchUserLogout)]);case 2:case\"end\":return _context5.stop();}},_marked3);}export default loginSaga;","map":{"version":3,"names":["watchUserLogin","_marked2","_regeneratorRuntime","mark","watchUserLogout","_marked3","loginSaga","takeEvery","fork","put","all","call","CHECK_LOGIN","LOGOUT_USER","apiError","loginUserSuccessful","logoutUserSuccess","postLogin","getFirebaseBackend","fireBaseBackend","loginUser","_ref","_ref$payload","payload","user","history","_callee","response","_response","wrap","_callee$","_context","prev","next","process","env","REACT_APP_DEFAULTAUTH","username","password","sent","localStorage","setItem","JSON","stringify","push","t0","stop","logoutUser","_ref2","_callee2","_callee2$","_context2","removeItem","logout","watchUserLogin$","_context3","_marked","watchUserLogout$","_context4","loginSaga$","_context5"],"sources":["D:/excercise-t/src/store/auth/login/saga.js"],"sourcesContent":["import { takeEvery, fork, put, all, call } from 'redux-saga/effects';\r\n\r\n// Login Redux States\r\nimport { CHECK_LOGIN, LOGOUT_USER } from './actionTypes';\r\nimport { apiError, loginUserSuccessful, logoutUserSuccess } from './actions';\r\n\r\n// AUTH related methods\r\nimport { postLogin } from '../../../helpers/fackBackend_Helper';\r\nimport { getFirebaseBackend } from '../../../helpers/firebase_helper';\r\n\r\n//Initilize firebase\r\nconst fireBaseBackend = getFirebaseBackend();\r\n\r\n//If user is login then dispatch redux action's are directly from here.\r\nfunction* loginUser({ payload: { user, history } }) {\r\n        try {\r\n            if(process.env.REACT_APP_DEFAULTAUTH === \"firebase\") {\r\n                const response = yield call(fireBaseBackend.loginUser, user.username, user.password);\r\n                yield put(loginUserSuccessful(response));\r\n            }\r\n            else {\r\n                const response = yield call(postLogin, '/post-login', {username: user.username, password: user.password});\r\n                localStorage.setItem(\"authUser\", JSON.stringify(response));\r\n                yield put(loginUserSuccessful(response));\r\n            }\r\n            history.push('/dashboard');\r\n        } catch (error) {\r\n            yield put(apiError(error));\r\n        }\r\n}\r\n\r\nfunction* logoutUser({ payload: { history } }) {\r\n    try {\r\n        localStorage.removeItem(\"authUser\");\r\n\r\n        if (process.env.REACT_APP_DEFAULTAUTH === 'firebase') {\r\n            const response = yield call(fireBaseBackend.logout);\r\n            yield put(logoutUserSuccess(response));\r\n        }\r\n\r\n        history.push('/login');\r\n    } catch (error) {\r\n        yield put(apiError(error));\r\n    }\r\n}\r\n\r\nexport function* watchUserLogin() {\r\n    yield takeEvery(CHECK_LOGIN, loginUser)\r\n}\r\n\r\nexport function* watchUserLogout() {\r\n    yield takeEvery(LOGOUT_USER, logoutUser)\r\n}\r\n\r\nfunction* loginSaga() {\r\n    yield all([\r\n        fork(watchUserLogin),\r\n        fork(watchUserLogout),\r\n    ]);\r\n}\r\n\r\nexport default loginSaga;"],"mappings":"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"},"metadata":{},"sourceType":"module"}